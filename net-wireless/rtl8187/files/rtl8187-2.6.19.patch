diff -Nurp rtl8187_linuxdrv_V1.1.orig/beta-8187/r8187_core.c rtl8187_linuxdrv_V1.1/beta-8187/r8187_core.c
--- rtl8187_linuxdrv_V1.1.orig/beta-8187/r8187_core.c	2006-12-25 13:08:29.000000000 +0100
+++ rtl8187_linuxdrv_V1.1/beta-8187/r8187_core.c	2006-12-25 13:15:38.000000000 +0100
@@ -2382,7 +2382,14 @@ static int __devinit rtl8187_usb_probe(s
 	dev->do_ioctl = rtl8180_ioctl;
 	dev->set_multicast_list = r8180_set_multicast;
 	dev->set_mac_address = r8180_set_mac_adr;
+
+#if WIRELESS_EXT >= 12
+#if WIRELESS_EXT < 17
 	dev->get_wireless_stats = r8180_get_wireless_stats;
+#endif
+	dev->wireless_handlers = (struct iw_handler_def *) &r8180_wx_handlers_def;
+#endif
+
 	dev->type=ARPHRD_ETHER;
 	
 	if (dev_alloc_name(dev, ifname) < 0){
diff -Nurp rtl8187_linuxdrv_V1.1.orig/beta-8187/r8187.h rtl8187_linuxdrv_V1.1/beta-8187/r8187.h
--- rtl8187_linuxdrv_V1.1.orig/beta-8187/r8187.h	2005-11-08 15:10:00.000000000 +0100
+++ rtl8187_linuxdrv_V1.1/beta-8187/r8187.h	2006-12-25 13:11:01.000000000 +0100
@@ -26,7 +26,12 @@
 
 #include <linux/module.h>
 #include <linux/kernel.h>
-#include <linux/config.h>
+#include <linux/version.h>
+#if LINUX_VERSION_CODE <= KERNEL_VERSION(2,6,18)
+	#include <linux/config.h>
+#else
+	#include <linux/autoconf.h>
+#endif
 #include <linux/init.h>
 #include <linux/ioport.h>
 #include <linux/sched.h>
@@ -43,7 +48,6 @@
 #include <linux/proc_fs.h>	// Necessary because we use the proc fs
 #include <linux/if_arp.h>
 #include <linux/random.h>
-#include <linux/version.h>
 #include <asm/io.h>
 #include <asm/semaphore.h>
 
diff -Nurp rtl8187_linuxdrv_V1.1.orig/ieee80211/ieee80211_crypt.c rtl8187_linuxdrv_V1.1/ieee80211/ieee80211_crypt.c
--- rtl8187_linuxdrv_V1.1.orig/ieee80211/ieee80211_crypt.c	2005-06-06 20:57:45.000000000 +0200
+++ rtl8187_linuxdrv_V1.1/ieee80211/ieee80211_crypt.c	2006-12-25 13:12:03.000000000 +0100
@@ -11,8 +11,12 @@
  *
  */
 
-#include <linux/config.h>
 #include <linux/version.h>
+#if LINUX_VERSION_CODE <= KERNEL_VERSION(2,6,18)
+        #include <linux/config.h>
+#else
+        #include <linux/autoconf.h>
+#endif
 #include <linux/module.h>
 #include <linux/init.h>
 #include <linux/slab.h>
diff -Nurp rtl8187_linuxdrv_V1.1.orig/ieee80211/ieee80211_crypt_ccmp.c rtl8187_linuxdrv_V1.1/ieee80211/ieee80211_crypt_ccmp.c
--- rtl8187_linuxdrv_V1.1.orig/ieee80211/ieee80211_crypt_ccmp.c	2005-10-14 14:02:53.000000000 +0200
+++ rtl8187_linuxdrv_V1.1/ieee80211/ieee80211_crypt_ccmp.c	2006-12-25 13:12:59.000000000 +0100
@@ -9,8 +9,12 @@
  * more details.
  */
 
-#include <linux/config.h>
 #include <linux/version.h>
+#if LINUX_VERSION_CODE <= KERNEL_VERSION(2,6,18)
+        #include <linux/config.h>
+#else
+        #include <linux/autoconf.h>
+#endif
 #include <linux/module.h>
 #include <linux/init.h>
 #include <linux/slab.h>
diff -Nurp rtl8187_linuxdrv_V1.1.orig/ieee80211/ieee80211_crypt_tkip.c rtl8187_linuxdrv_V1.1/ieee80211/ieee80211_crypt_tkip.c
--- rtl8187_linuxdrv_V1.1.orig/ieee80211/ieee80211_crypt_tkip.c	2005-10-14 14:02:33.000000000 +0200
+++ rtl8187_linuxdrv_V1.1/ieee80211/ieee80211_crypt_tkip.c	2006-12-25 13:12:39.000000000 +0100
@@ -9,8 +9,12 @@
  * more details.
  */
 
-#include <linux/config.h>
 #include <linux/version.h>
+#if LINUX_VERSION_CODE <= KERNEL_VERSION(2,6,18)
+        #include <linux/config.h>
+#else
+        #include <linux/autoconf.h>
+#endif
 #include <linux/module.h>
 #include <linux/init.h>
 #include <linux/slab.h>
diff -Nurp rtl8187_linuxdrv_V1.1.orig/ieee80211/ieee80211_crypt_wep.c rtl8187_linuxdrv_V1.1/ieee80211/ieee80211_crypt_wep.c
--- rtl8187_linuxdrv_V1.1.orig/ieee80211/ieee80211_crypt_wep.c	2005-06-06 20:57:45.000000000 +0200
+++ rtl8187_linuxdrv_V1.1/ieee80211/ieee80211_crypt_wep.c	2006-12-25 13:13:49.000000000 +0100
@@ -9,8 +9,12 @@
  * more details.
  */
 
-#include <linux/config.h>
 #include <linux/version.h>
+#if LINUX_VERSION_CODE <= KERNEL_VERSION(2,6,18)
+        #include <linux/config.h>
+#else
+        #include <linux/autoconf.h>
+#endif
 #include <linux/module.h>
 #include <linux/init.h>
 #include <linux/slab.h>
diff -Nurp rtl8187_linuxdrv_V1.1.orig/ieee80211/ieee80211_module.c rtl8187_linuxdrv_V1.1/ieee80211/ieee80211_module.c
--- rtl8187_linuxdrv_V1.1.orig/ieee80211/ieee80211_module.c	2005-10-24 20:35:01.000000000 +0200
+++ rtl8187_linuxdrv_V1.1/ieee80211/ieee80211_module.c	2006-12-25 13:11:38.000000000 +0100
@@ -31,7 +31,12 @@
 *******************************************************************************/
 
 #include <linux/compiler.h>
-#include <linux/config.h>
+#include <linux/version.h>
+#if LINUX_VERSION_CODE <= KERNEL_VERSION(2,6,18)
+        #include <linux/config.h>
+#else
+        #include <linux/autoconf.h>
+#endif
 #include <linux/errno.h>
 #include <linux/if_arp.h>
 #include <linux/in6.h>
@@ -46,7 +51,6 @@
 #include <linux/slab.h>
 #include <linux/tcp.h>
 #include <linux/types.h>
-#include <linux/version.h>
 #include <linux/wireless.h>
 #include <linux/etherdevice.h>
 #include <asm/uaccess.h>
diff -Nurp rtl8187_linuxdrv_V1.1.orig/ieee80211/ieee80211_rx.c rtl8187_linuxdrv_V1.1/ieee80211/ieee80211_rx.c
--- rtl8187_linuxdrv_V1.1.orig/ieee80211/ieee80211_rx.c	2005-11-14 19:41:15.000000000 +0100
+++ rtl8187_linuxdrv_V1.1/ieee80211/ieee80211_rx.c	2006-12-25 13:13:36.000000000 +0100
@@ -22,7 +22,12 @@
  
 
 #include <linux/compiler.h>
-#include <linux/config.h>
+#include <linux/version.h>
+#if LINUX_VERSION_CODE <= KERNEL_VERSION(2,6,18)
+        #include <linux/config.h>
+#else
+        #include <linux/autoconf.h>
+#endif
 #include <linux/errno.h>
 #include <linux/if_arp.h>
 #include <linux/in6.h>
@@ -37,7 +42,6 @@
 #include <linux/slab.h>
 #include <linux/tcp.h>
 #include <linux/types.h>
-#include <linux/version.h>
 #include <linux/wireless.h>
 #include <linux/etherdevice.h>
 #include <asm/uaccess.h>
diff -Nurp rtl8187_linuxdrv_V1.1.orig/ieee80211/ieee80211_tx.c rtl8187_linuxdrv_V1.1/ieee80211/ieee80211_tx.c
--- rtl8187_linuxdrv_V1.1.orig/ieee80211/ieee80211_tx.c	2005-10-24 22:23:41.000000000 +0200
+++ rtl8187_linuxdrv_V1.1/ieee80211/ieee80211_tx.c	2006-12-25 13:13:21.000000000 +0100
@@ -32,7 +32,12 @@
 ******************************************************************************/
 
 #include <linux/compiler.h>
-#include <linux/config.h>
+#include <linux/version.h>
+#if LINUX_VERSION_CODE <= KERNEL_VERSION(2,6,18)
+        #include <linux/config.h>
+#else
+        #include <linux/autoconf.h>
+#endif
 #include <linux/errno.h>
 #include <linux/if_arp.h>
 #include <linux/in6.h>
@@ -47,7 +52,6 @@
 #include <linux/slab.h>
 #include <linux/tcp.h>
 #include <linux/types.h>
-#include <linux/version.h>
 #include <linux/wireless.h>
 #include <linux/etherdevice.h>
 #include <asm/uaccess.h>
