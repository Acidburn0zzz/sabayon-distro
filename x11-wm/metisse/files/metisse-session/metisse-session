#!/bin/sh
if [ -z "$1" ]; then
  default_session="gnome-session"
elif [ "$1" = "kde" ]; then
  default_session="startkde"
else
  default_session="gnome-session"
fi

export COMPOSITING_SERVER_SPAWNS_WINDOW=no
export COMPOSITING_SERVER_FORCE_GEOMETRY=yes
export XKL_XMODMAP_DISABLE=1


# FIXME: get resolution
current_resolution=$(xdpyinfo | grep dimensions | sed 's/ //g' | cut -dp -f 1 | cut -d: -f2)

if [ "$default_session" == "gnome-session" ]; then
  gnome-session-remove metacity
fi

killall Xmetisse &> /dev/null
Xmetisse  -dpi 96 -ac -depth 24 -geometry $current_resolution :1 & metisse-start-fvwm &
DISPLAY=":1" $default_session
